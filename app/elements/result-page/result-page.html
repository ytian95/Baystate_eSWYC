<link rel="import" href="../../bower_components/polymer/polymer.html">
<link rel="import" href="../../bower_components/paper-toolbar/paper-toolbar.html">
<link rel="import" href="../../bower_components/paper-button/paper-button.html">
<link rel="import" href="../../bower_components/paper-header-panel/paper-header-panel.html">           
            
<dom-module id="result-page">
    <link rel="import" type="css" href="result-page.css">
    <template>
        <paper-header-panel id="header" mode="seamed">
            <paper-toolbar>
                <div id="headerName">Patient's Result <span>{{age}}</span> months</div>
            </paper-toolbar>
        </paper-header-panel>
        <paper-button id ="dmstatus">Developmental Milestones Score: <span>{{dmscore}}</span>
        </paper-button>
        <br/>
        <canvas id="canvas"></canvas>
        <br/>
    	<paper-button id ="bpscstatus">BPSC Score: <span>{{bpscscore}}</span>
        </paper-button>
    
    
    </template>
    <script>

        Polymer({
            is: 'result-page',
        	properties: {
            	version: {
                	type: Number,
                	notify: true,
            	},   
            	age: {
            		type: Number,
            		notify: true,
            	},  
                dmscore: {
                	type: Number,
                	notify: true,
                	value: 0,
                	observer: '_scoreChanged',
                },
                bpscscore: {
                	type: Number,
                	notify: true,
                	value: 0,
                	observer: '_scoreChanged',
                },        		
        	},
        	_scoreChanged: function(){
        		var scaleRatio = 30;
        		var canvas = this.$$('#canvas');
        		canvas.width = innerWidth;
        		canvas.height = 100;
				var g = canvas.getContext("2d");
				if(this.age === 2){
					g.fillStyle = "#de2b41";
					g.fillRect(30, 50, 13*scaleRatio,30); 
    				g.fill();
    				g.fillStyle = "#0fa955";
					g.fillRect(30 + 13*scaleRatio, 50, (15-13)*scaleRatio,30);
    				g.fill();
    				g.fillStyle = "#f8da25";
					g.fillRect(30 + 15*scaleRatio, 50, (20-15)*scaleRatio,30);
    				g.fill();  

    				g.fillStyle = "white";
					g.font = "13px Arial";
					g.fillText("Below Average : <= 13 ", 35 ,70);
					g.fillText("Average",35 + 13*scaleRatio,70);
					g.fillText("Above Average : >15",35 + 15*scaleRatio,70);
										
    				g.beginPath();    				
					g.moveTo(30+this.dmscore*scaleRatio,30);
					g.lineTo(30+this.dmscore*scaleRatio,90);
					g.stroke();
    				  				
					if(this.dmscore > 13){
    					this.$$('#dmstatus').style.background = "#0fa955";
    				} else {
    	    			this.$$('#dmstatus').style.background = "#de2b41";
    				};
				} else if (this.age === 3){
					g.fillStyle = "#de2b41";
					g.fillRect(30, 50, 16*scaleRatio,30);
    				g.fill();
    				g.fillStyle = "#0fa955";
					g.fillRect(30 + 16*scaleRatio, 50, (17-16)*scaleRatio,30);
    				g.fill();
    				g.fillStyle = "#f8da25";
					g.fillRect(30 + 17*scaleRatio, 50, (20-17)*scaleRatio,30);
    				g.fill(); 
    				g.fillStyle = "white";
					g.font = "13px Arial";
					g.fillText("Average",35 + 16*scaleRatio,65);
					g.fillText("17",35 + 16*scaleRatio,78);
    				g.beginPath();    				
					g.moveTo(30+this.dmscore*scaleRatio,30);
					g.lineTo(30+this.dmscore*scaleRatio,90);
					g.stroke(); 
    				  			
					if(this.demscore > 16){
    					this.$$('#dmstatus').style.background = "#0fa955";
    				} else {
    	    			this.$$('#dmstatus').style.background = "#de2b41";
    				};
				};
    
				if(this.bpscscore < 3){
    				this.$$('#bpscstatus').style.background = "#0fa955";
    			} else {
    	    		this.$$('#bpscstatus').style.background = "#de2b41";
				};
        	},
        	
        });
    </script>
</dom-module>